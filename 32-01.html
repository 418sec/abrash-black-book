<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="vsisbn" content="1576101746" />
  <meta name="vstitle" content="Michael Abrash's Graphics Programming Black Book, Special Edition" />
  <meta name="vsauthor" content="Michael Abrash" />
  <meta name="vspublisher" content="The Coriolis Group" />
  <meta name="vspubdate" content="07/01/97" />
  <meta name="vscategory" content="Web and Software Development: Game Development,Web and Software Development: Graphics and Multimedia Development" />

  <title>Michael Abrash's Graphics Programming Black Book Special Edition: Be It Resolved: 360x480</title><!-- HEADER -->
  <!-- Empty Reference Subhead -->
  <!--ISBN=1576101746//-->
  <!--TITLE=Michael Abrash's Graphics Programming Black Book Special Edition//-->
  <!--AUTHOR=Michael Abrash//-->
  <!--PUBLISHER=The Coriolis Group, Inc.//-->
  <meta name="chapter" content="32" />
  <meta name="pages" content="607-611" />
  <!--UNASSIGNED1//-->
  <!--UNASSIGNED2//-->
</head>

<body>
  <center>
    <table border="1">
      <tr>
        <td><a href="31-05.html">Previous</a></td>

        <td><a href="index.html">Table of Contents</a></td>

        <td><a href="32-02.html">Next</a></td>
      </tr>
    </table>
  </center>

  <p><br /></p>

  <h2><a id="Heading1"></a>Chapter 32<br />
  Be It Resolved: 360x480</h2>

  <h3><a id="Heading2"></a>Taking 256-Color Modes About as Far as the Standard VGA Can Take Them</h3>

  <p>In the last chapter, we learned how to coax 320x400 256-color resolution out of a standard VGA. At the time, I noted that the VGA was actually capable of supporting 256-color resolutions as high as 360x480, but didn&rsquo;t pursue the topic further, preferring to concentrate on the versatile and easy-to-set 320x400 256-color mode instead.</p>

  <p>Some time back I was sent a particularly useful item from John Bridges, a longtime correspondent and an excellent programmer. It was a complete mode set routine for 360x480 256-color mode that he has placed into the public domain. In addition, John wrote, &ldquo;I also have a couple of freeware (free, but not public domain) utilities out there, including PICEM, which displays PIC, PCX, and GIF images not only in 360x480x256 but also in 640x350x256, 640x400x256, 640x480x256, and 800x600x256 on SuperVGAs.&rdquo;</p>

  <p>In this chapter, I&rsquo;m going to combine John&rsquo;s mode set code with appropriately modified versions of the dot-plot code from Chapter 31 and the line-drawing code that we&rsquo;ll develop in Chapter 35. Together, those routines will make a pretty nifty demo of the capabilities of 360x480 256-color mode.</p>

  <h3><a id="Heading3"></a>Extended 256-Color Modes: What&rsquo;s Not to Like?</h3>

  <p>When last we left 256-color programming, we had found that the standard 256-color mode, mode 13H, which officially offers 320x200 resolution, actually displays 400, not 200, scan lines, with line-doubling used to reduce the effective resolution to 320x200. By tweaking a few of the VGA&rsquo;s mode registers, we converted mode 13H to a true 320x400 256-color mode. As an added bonus, that 320x400 mode supports two graphics pages, a distinct improvement over the single graphics page supported by mode 13H. (We also learned how to get <i>four</i> graphics pages at 320x200 resolution, should that be needed.)</p>

  <p>I particularly like 320x400 256-color mode for two reasons: It supports two-page graphics, which is very important for animation applications; and it doesn&rsquo;t require changing any of the monitor timing characteristics of the VGA. The mode bits that we changed to produce 320x400 256-color mode are pretty much guaranteed to be the same from one VGA to another, but the monitor-oriented registers are less certain to be constant, especially for VGAs that provide special support for the extended capabilities of various multiscanning monitors.</p>

  <p>All in all, those are good arguments for 320x400 256-color mode. However, the counter-argument seems compelling as well&mdash;nothing beats higher resolution for producing striking graphics. Given that, and given that John Bridges was kind enough to make his mode set code available, I&rsquo;m going to look at 360x480 256mode next. However, bear in mind that the drawbacks of this mode are the flip side of the strengths of 320x400 256-color mode: Only one graphics page, and direct setting of the monitorregisters. Also, this mode has a peculiar and unique aspect ratio, with 480 pixels (as many as high-resolution mode 12H) vertically and only 360 horizontally. That makes for fairly poor horizontal resolution and sometimes-jagged drawing; on the other hand, the resolution is better in both directions than in mode 13H, and mode 13H itself has an odd aspect ratio, so it seems a bit petty to complain.</p>

  <p>The single graphics page isn&rsquo;t a drawback if you don&rsquo;t need page flipping, of course, so there&rsquo;s not much to worry about there: If you need page flipping, don&rsquo;t use this mode. The direct setting of the monitor-oriented registers is another matter altogether.</p>

  <p>I don&rsquo;t know how likely this code is to produce problems with clone VGAs in general; however, I did find that I had to put an older Video Seven VRAM VGA into &ldquo;pure&rdquo; mode&mdash;where it treats the VRAMs as DRAMs and exactly emulates a plain-vanilla IBM VGA&mdash;before 360x480 256-color mode would work properly. Now, that particular problem was due to an inherent characteristic of VRAMs, and shouldn&rsquo;t occur on Video Seven&rsquo;s Fastwrite adapter or any other VGA clone. Nonetheless, 360x480 256-color mode is a good deal different from any standard VGA mode, and while the code in this chapter runs perfectly well on all other VGAs in my experience, I can&rsquo;t guarantee its functionality on any particular VGA/monitor combination, unlike 320x400 256-color mode. Mind you, 360x480 256-color mode <i>should</i> work on all VGAs&mdash;there are just too many variables involved for me to be certain. Feedback from readers with broad 360x480 256-color experience is welcome.</p>

  <p>The above notwithstanding, 360x480 256-color mode offers 64 times as many colors and nearly three times as many pixels as IBM&rsquo;s original CGA color graphics mode, making startlingly realistic effects possible. No mode of the VGA (at least no mode that I know of!), documented or undocumented, offers a better combination of resolution and color; even 320x400 256-color mode has 26 percent fewer pixels.</p>

  <p>In other words, 360x480 256-color mode is worth considering&mdash;so let&rsquo;s have a look.</p>

  <h3><a id="Heading4"></a>360x480 256-Color Mode</h3>

  <p>I&rsquo;m going to start by showing you 360x480 256-color mode in action, after which we&rsquo;ll look at how it works. I suspect that once you see what this mode looks like, you&rsquo;ll be more than eager to learn how to use it.</p>

  <p>Listing 32.1 contains three C-callable assembly functions. As you would expect, <b>Set360x480Mode</b> places the VGA into 360x480 256mode. <b>Draw360x480Dot</b> draws a pixel of the specified color at the specified location. Finally, <b>Read360x480Dot</b> returns the color of the pixel at the specified location. (This last function isn&rsquo;t actually used in the example program in this chapter, but is included for completeness.)</p>

  <p>Listing 32.2 contains an adaptation of some C linecode I&rsquo;ll be presenting shortly in Chapter 35. If you&rsquo;re reading this book in serial fashion and haven&rsquo;t gotten there yet, simply take it on faith. If you really <i>really</i> need to know how the line-draw code works right <i>now</i>, by all means make a short forward call to Chapter 35 and digest it. The line-draw code presented below has been altered to select 360x480 256-color mode, and to cycle through all 256 colors that this mode supports, drawing each line in a different color.</p>

  <p><br /></p>

  <center>
    <table border="1">
      <tr>
        <td><a href="31-05.html">Previous</a></td>

        <td><a href="index.html">Table of Contents</a></td>

        <td><a href="32-02.html">Next</a></td>
      </tr>
    </table>
  </center>
  <hr width="90%" size="1" noshade="noshade" />

  <div align="center">
    Graphics Programming Black Book &copy; 2001 Michael Abrash
  </div><!-- all of the reference materials (books) have the footer and subfoot reveresed -->
  <!-- reference_subfoot = footer -->
  <!-- reference_footer = subfoot -->
  <!-- BEGIN SUB FOOTER -->
  <!-- END FOOTER -->
</body>
</html>
