<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="vsisbn" content="1576101746" />
  <meta name="vstitle" content="Michael Abrash's Graphics Programming Black Book, Special Edition" />
  <meta name="vsauthor" content="Michael Abrash" />
  <meta name="vspublisher" content="The Coriolis Group" />
  <meta name="vspubdate" content="07/01/97" />
  <meta name="vscategory" content="Web and Software Development: Game Development,Web and Software Development: Graphics and Multimedia Development" />

  <title>Michael Abrash's Graphics Programming Black Book Special Edition: Color Modeling in 256-Color Mode</title>
  <meta name="chapter" content="55" />
  <meta name="pages" content="1031-1035" />
</head>

<body>
  <center>
    <table border="1">
      <tr>
        <td><a href="54-05.html">Previous</a></td>

        <td><a href="index.html">Table of Contents</a></td>

        <td><a href="55-02.html">Next</a></td>
      </tr>
    </table>
  </center>

  <p><br /></p>

  <h2 id="Heading1">Chapter 55<br />
  Color Modeling in 256-Color Mode</h2>

  <h3 id="Heading2">Pondering X-Sharp&rsquo;s Color Model in an RGB State of Mind</h3>

  <p>Once she turned six, my daughter wanted some fairly sophisticated books read to her<i>. Wind in the Willows.</i> <i>Little House on the Prairie.</i> Pretty heady stuff for one so young, and sometimes I wondered how much of it she really understood. As an experiment, during one reading I stopped whenever I came to a word I thought she might not know, and asked her what it meant. One such word was &ldquo;mulling.&rdquo;</p>

  <p>&ldquo;Do you know what &lsquo;mulling&rsquo; means?&rdquo; I asked.</p>

  <p>She thought about it for a while, then said, &ldquo;Pondering.&rdquo;</p>

  <p>&ldquo;Very good!&rdquo; I said, more than a little surprised.</p>

  <p>She smiled and said, &ldquo;But, Dad, how do you know that I know what &lsquo;pondering&rsquo; means?&rdquo;</p>

  <p>&ldquo;Okay,&rdquo; I said, &ldquo;What does &lsquo;pondering&rsquo; mean?&rdquo;</p>

  <p>&ldquo;Mulling,&rdquo; she said.</p>

  <p>What does this anecdote tell us about the universe in which we live? Well, it certainly indicates that this universe is inhabited by at least one comedian and one good straight man. Beyond that, though, it can be construed as a parable about the difficulty of defining things properly; for example, consider the complications inherent in the definition of color on a 256-color display adapter such as the VGA. Coincidentally, VGA color modeling just happens to be this chapter&rsquo;s topic, and the place to start is with color modeling in general.</p>

  <h4 align="left" id="Heading3">A Color Model</h4>

  <p>We&rsquo;ve been developing X-Sharp for several chapters now. In the previous chapter, we added illumination sources and shading; that addition makes it necessary for us to have a general-purpose color model, so that we can display the gradations of color intensity necessary to render illuminated surfaces properly. In other words, when a bright light is shining straight at a green surface, we need to be able to display bright green, and as that light dims or tilts to strike the surface at a shallower angle, we need to be able to display progressively dimmer shades of green.</p>

  <p>The first thing to do is to select a color model in which to perform our shading calculations. I&rsquo;ll use the dot product-based stuff I discussed in the previous chapter. The approach we&rsquo;ll take is to select an ideal representation of the full color space and do our calculations there, as if we really could display every possible color; only as a final step will we map each desired color into the limited 256-color set of the VGA, or the color range of whatever adapter we happen to be working with. There are a number of color models that we might choose to work with, but I&rsquo;m going to go with the one that&rsquo;s both most familiar and, in my opinion, simplest: RGB (red, green, blue).</p>

  <p>In the RGB model, a given color is modeled as the mix of specific fractions of full intensities of each of the three color primaries. For example, the brightest possible pure blue is 0.0*R, 0.0*G, 1.0*B. Half-bright cyan is 0.0*R, 0.5*G, 0.5*B. Quarter-bright gray is 0.25*R, 0.25*G, 0.25*B. You can think of RGB color space as being a cube, as shown in Figure 55.1, with any particular color lying somewhere inside or on the cube.</p>

  <p><a id="Fig1"><img src="images/55-01.jpg" /><br />
  <b>Figure 55.1</b></a>&nbsp;&nbsp;<i>The RGB color cube.</i></p>

  <p>RGB is good for modeling colors generated by light sources, because red, green, and blue are the additive primaries; that is, all other colors can be generated by mixing red, green, and blue light sources. They&rsquo;re also the primaries for color computer displays, and the RGB model maps beautifully onto the display capabilities of 15- and 24-bpp display adapters, which tend to represent pixels as RGB combinations in display memory.</p>

  <p>How, then, are RGB colors represented in X-Sharp? Each color is represented as an RGB triplet, with eight bits each of red, green, and blue resolution, using the structure shown in Listing 55.1.</p>

  <p><b>LISTING 55.1 L55-1.C</b></p>
  <pre>
 typedef struct -ModelColor {
    unsigned char Red;   /* 255 = max red, 0 = no red */
    unsigned char Green; /* 255 = max green, 0 = no green */
    unsigned char Blue;  /* 255 = max blue, 0 = no blue */
 } ModelColor;

</pre>

  <p>Here, each color is described by three color components&mdash;one each for red, green, and blue&mdash;and each primary color component is represented by eight bits. Zero intensity of a color component is represented by the value 0, and full intensity is represented by the value 255. This gives us 256 levels of each primary color component, and a total of 16,772,216 possible colors.</p>

  <p>Holy cow! Isn&rsquo;t 16,000,000-plus colors a bit of overkill?</p>

  <p>Actually, no, it isn&rsquo;t. At the eighth Annual Computer Graphics Show in New York, Sheldon Linker, of Linker Systems, related an interesting tale about color perception research at the Jet Propulsion Lab back in the &rsquo;70s. The JPL color research folks had the capability to print more than 50,000,000 distinct and very precise colors on paper. As a test, they tried printing out words in various colors, with each word printed on a background that differed by only one color index from the word&rsquo;s color. No one expected the human eye to be able to differentiate between two colors, out of 50,000,000-plus, that were so similar. It turned out, though, that everyone could read the words with no trouble at all; the human eye is surprisingly sensitive to color gradations, and also happens to be wonderful at detecting edges.</p>

  <p>When the JPL team went to test the eye&rsquo;s sensitivity to color on the screen, they found that only about 16,000,000 colors could be distinguished, because the color-sensing mechanism of the human eye is more compatible with reflective sources such as paper and ink than with emissive sources such as CRTs. Still, the human eye can distinguish about 16,000,000 colors on the screen. That&rsquo;s not so hard to believe, if you think about it; the eye senses each primary color separately, so we&rsquo;re really only talking about detecting 256 levels of intensity per primary here. It&rsquo;s the brain that does the amazing part; the 16,000,000-plus color capability actually comes not from extraordinary sensitivity in the eye, but rather from the brain&rsquo;s ability to distinguish between all the mixes of 256 levels of each of three primaries.</p>

  <p><br /></p>

  <center>
    <table border="1">
      <tr>
        <td><a href="54-05.html">Previous</a></td>

        <td><a href="index.html">Table of Contents</a></td>

        <td><a href="55-02.html">Next</a></td>
      </tr>
    </table>
  </center>
  <hr width="90%" size="1" noshade="noshade" />

  <div align="center">
    Graphics Programming Black Book &copy; 2001 Michael Abrash
  </div>
</body>
</html>
